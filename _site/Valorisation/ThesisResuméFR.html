<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Arthur Heim">
<meta name="dcterms.date" content="2024-08-10">

<title>Arthur Heim - Investissement social et nouvelles formes de pauvreté</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../styles.css">
<meta property="og:title" content="Arthur Heim - Investissement social et nouvelles formes de pauvreté">
<meta property="og:description" content="Un résumé">
<meta property="og:site_name" content="Arthur Heim">
<meta name="twitter:title" content="Arthur Heim - Investissement social et nouvelles formes de pauvreté">
<meta name="twitter:description" content="Un résumé">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Arthur Heim</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> <i class="bi bi-house-heart" role="img">
</i> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../CVContacts.html"> <i class="bi bi-person-lines-fill" role="img">
</i> 
<span class="menu-text">CV and contact</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../PhD/PhDPage.html"> <i class="bi bi-mortarboard-fill" role="img">
</i> 
<span class="menu-text">PhD dissertation</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../ISAJE/IsajeMain.html"> <i class="bi bi-bar-chart-steps" role="img">
</i> 
<span class="menu-text">Ongoing research</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Teachings/Teachings.html"> <i class="bi bi-clipboard2-data-fill" role="img">
</i> 
<span class="menu-text">Teachings</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Publications/Publications.html"> <i class="bi bi-journal-bookmark-fill" role="img">
</i> 
<span class="menu-text">Publications</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Publications/Music.html"> <i class="bi bi-music-note-beamed" role="img">
</i> 
<span class="menu-text">Music</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools tools-wide">
    <a href="mailto:heimarthur@gmail.com" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-mailbox-flag"></i></a>
    <a href="https://x.com/HeimArthur" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-twitter"></i></a>
    <div class="dropdown">
      <a href="" title="" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label=""><i class="bi bi-github"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://github.com/arthurheim/Personal-Website">
            Source Code
            </a>
          </li>
      </ul>
    </div>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a>
  <ul class="collapse">
  <li><a href="#cadre-danalyse-et-problématique" id="toc-cadre-danalyse-et-problématique" class="nav-link" data-scroll-target="#cadre-danalyse-et-problématique">Cadre d’analyse et problématique</a></li>
  <li><a href="#problématique" id="toc-problématique" class="nav-link" data-scroll-target="#problématique">Problématique</a></li>
  </ul></li>
  <li><a href="#rage-against-the-matching" id="toc-rage-against-the-matching" class="nav-link" data-scroll-target="#rage-against-the-matching">Rage against the matching</a>
  <ul class="collapse">
  <li><a href="#market-design-et-économie-politique" id="toc-market-design-et-économie-politique" class="nav-link" data-scroll-target="#market-design-et-économie-politique">Market design et économie politique</a></li>
  <li><a href="#principale-contribution-théorique" id="toc-principale-contribution-théorique" class="nav-link" data-scroll-target="#principale-contribution-théorique">Principale contribution théorique</a></li>
  <li><a href="#implication-pour-les-politiques-publiques" id="toc-implication-pour-les-politiques-publiques" class="nav-link" data-scroll-target="#implication-pour-les-politiques-publiques">Implication pour les politiques publiques</a></li>
  </ul></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="ThesisResuméFR.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Investissement social et nouvelles formes de pauvreté</h1>
<p class="subtitle lead">Un résumé</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Arthur Heim </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">August 10, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>Ce document synthéthise la thèse de doctorat intitulé “<em>Investissement social et nouvelles formes de pauvreté”</em> soutenue le 24 Avril 2024 à l’École d’économie de Paris. Elle s’intéresse en particulier au problème des inégalités d’accès aux modes d’accueils formels et aux politiques de lutte contre la pauvreté à destination des familles monoparentales. Ces travaux ont été menés sous la direction de Marc Gurgand et à la Caisse nationale des allocations familiales dans le cadre d’un contrat CIFRE entre 2019 et 2022, puis d’un CDI qui continue au delà de la soutenance.</p>
<section id="cadre-danalyse-et-problématique" class="level2">
<h2 class="anchored" data-anchor-id="cadre-danalyse-et-problématique">Cadre d’analyse et problématique</h2>
<p>L’investissement social est une approche visant à reconfigurer l’intervention sociale et la protection sociale pour mieux accompagner les individus dans leurs trajectoires de vie<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> en réponse à l’évolution des besoins sociaux: transformations de la famille avec l’accroissement des divorces et la diversification des formes de ménages&nbsp;; transformations des relations sociales avec la baisse des grands collectifs d’actions, syndicats et clergés, les fortes aspirations à l’émancipation et la reconnaissance pour l’égalité des femmes, des personnes racisées, des personnes LGBTQIA+, etc; transformations de l’économie et des institutions avec la mondialisation, la construction européen, les progrès technologiques,…</p>
<p>Ces changements ont profondément perturbé les mécanismes traditionnels de l’État social et mis en lumière ses limites, engendrant une crise tripartite : financière, d’efficacité et de légitimité. Dans un contexte de contraintes budgétaires, la prise en charge des risques sociaux traditionnels tels que le chômage, la santé et les retraites devient de plus en plus problématique, tandis que les nouveaux risques ne sont que partiellement couverts : la pauvreté infantile, les difficultés d’insertion professionnelle des jeunes et des moins qualifiés, les défis liés à l’articulation entre vie familiale et vie professionnelle, ainsi que la perte d’autonomie. Les enjeux de soutenabilité ne se posent plus qu’en terme de dette publique et la gestion des conséquences de l’anthropocène mettent, davantage encore, les sociétés sous tension.</p>
<p>Dans le chapitre introductif, on</p>
<ol type="1">
<li>Une révolution silencieuse ayant mené, générations après générations, davantage de femmes - et d’autres minorités - à accroître leurs compétences et niveaux de diplômes, dépassant les niveaux des hommes ;</li>
<li>Des transformations du tissu économique augmentant la demande de travail qualifié offrant des débouchés pour les diplômés, mais réduisant la demande pour des emplois intermédiaires et peu qualifiés. Mondialisation etc favorisant l’accès à des biens et services à moindre coût pouvant libérer du temps, et des changements institutionnels favorisant la participation au marché du travail des femmes (temps partiels cdd etc) ;</li>
<li>Un phénomène d’appariement assortatif positif où les femmes les plus dotées en capital humain se mettent en relation avec des partenaires aux normes plus égalitaires et plus impliqués dans l’éducation des enfants ;</li>
<li>Mais face à une relative rareté d’hommes diplômés par rapport aux femmes, et des perspectives économiques de plus en plus sombre pour les hommes et les femmes les moins diplômées, les bénéfices d’une vie maritales sont moins élevés, la vulnérabilité économique et l’évolution des dynamiques de pouvoir au sein des foyers augmente les tensions dans les relations et favorise les séparations.</li>
<li>Les hommes et les femmes les moins diplômés se retrouvent alors plus souvent en situation d’isolement, avec des perspectives d’emploi limités et une plus grande vulnérabilité économique, moins de chance de trouver un ou une partenaire de “qualité”, ou des relations plus fragiles notamment du fait de la vulnérabilité économique.</li>
<li>Parmi les couples les plus éduqués, le mariage joue à la fois un rôle d’assurance en mutualisant une partie des ressources individuelles pour absorber les chocs économiques (période de chômage), et un puissant générateur d’épargne par des économies d’échelles dans la consommation, l’accès à des crédits favorisant l’accès à la propriété, alimentant le capital économique des membres du foyer et l’héritage à transmettre à leurs enfants.</li>
<li>Au sein d’une génération, les inégalités de revenus, de consommation, de patrimoine net, de taux et qualité de l’emploi augmentent.</li>
<li>Équipés d’un niveau plus élevé de ressources économiques et culturelles, et des préférences jointes pour l’éducation des enfants, les couples les plus dotés en capital humain investissent davantage dans l’éducation de leurs enfants que ceux moins éduqués et que les familles monoparentales, pour lesquels les contraintes de temps pèsent davantage.</li>
</ol>
<p>Dans un chapitre introductif,</p>
<p>Les trois années qui ont précédé ce projet ont été consacré à l’investissement social dans une mission jointe entre France stratégie et la Cnaf, et c’est au cours de cette première vie professionnelle que ce projet s’est consolidé.</p>
<p>L’investissement social est une approche visant à reconfigurer l’intervention sociale et la protection sociale pour mieux accompagner les individus dans leurs trajectoires de vie<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> en réponse à l’évolution des besoins sociaux. Cette approche met l’accent sur la nécessité d’intervenir en amont des situations, notamment dès la petite enfance, afin d’anticiper et de prévenir les risques. Il apparait dans une période où les modèles d’États providence sont bousculés par des mutations profondes des sociétés générant de nouveaux défis&nbsp;: transformations de la famille avec l’accroissement des divorces et la diversification des formes de ménages&nbsp;; transformations des relations sociales avec la baisse des grands collectifs d’actions, syndicats et clergés, les fortes aspirations à l’émancipation et la reconnaissance pour l’égalité des femmes, des personnes racisées, des personnes LGBTQIA+, etc; transformations de l’économie et des institutions avec la mondialisation, la construction européen, les progrès technologiques,…</p>
<p>Ces changements ont profondément perturbé les mécanismes traditionnels de l’État social et mis en lumière ses limites, engendrant une crise tripartite : financière, d’efficacité et de légitimité. Dans un contexte de contraintes budgétaires, la prise en charge des risques sociaux traditionnels tels que le chômage, la santé et les retraites devient de plus en plus problématique, tandis que les nouveaux risques ne sont que partiellement couverts : la pauvreté infantile, les difficultés d’insertion professionnelle des jeunes et des moins qualifiés, les défis liés à l’articulation entre vie familiale et vie professionnelle, ainsi que la perte d’autonomie. Les enjeux de soutenabilité ne se posent plus qu’en terme de dette publique et la gestion des conséquences de l’anthropocène mettent, davantage encore, les sociétés sous tension.</p>
</section>
<section id="problématique" class="level2">
<h2 class="anchored" data-anchor-id="problématique">Problématique</h2>
<p>Alors que l’investissement social occupe une place de choix dans la conception des politiques publiques dans la plupart des pays de l’OCDE et revêt une importance centrale dans d’autres domaines des sciences sociales, cette notion reste relativement marginale en économie. Néanmoins, dans cette thèse, je l’adopte comme cadre général pour concevoir et évaluer les politiques de la petite enfance ainsi que les politiques actives du marché du travail destinées aux familles monoparentales. Dans les deux cas, l’investissement social fournit des objectifs politiques ainsi que des critères normatifs permettant de juger les effets souhaités, les externalités et d’évaluer le succès ou l’échec des politiques mises en œuvre. Pour ce faire, je concentre mon analyse sur les trois principaux récits du paradigme de l’investissement social :</p>
<ol type="1">
<li>Investir dans la petite enfance pour réduire les inégalités et rompre le cycle intergénérationnel de la pauvreté&nbsp;;</li>
<li>L’activation comme moyen de favoriser l’emploi et de réduire la pauvreté&nbsp;;</li>
<li>Les suppléments de revenu pour rendre le travail rémunérateur.</li>
</ol>
<p>En France, la littérature sur les effets des investissements sociaux dans la petite enfance ou dans les politiques actives du marché du travail est relativement limitée <span class="citation" data-cites="bono2021">(<a href="#ref-bono2021" role="doc-biblioref">Bono et al. 2021</a>)</span>. En particulier, il n’existe pas de preuves expérimentales des effets de l’accès à la garde d’enfants ou des programmes de transition du bien-être au travail pour les familles monoparentales. Cette thèse vise à combler cette lacune en proposant une approche expérimentale pour les deux cas. Ma principale contribution réside dans l’utilisation de méthodes économiques de pointe pour répondre à la question de recherche suivante :</p>
<ul>
<li><strong>Comment les politiques d’investissement social affectent-elles la dynamique de la pauvreté en France ?</strong></li>
</ul>
<p>Chaque chapitre aborde un puzzle spécifique :</p>
<ul>
<li><strong>Puzzle n°1</strong> : Pour que les politiques petite enfance puissent atteindre les objectifs qui leurs sont assignés, il est nécessaire de s’assurer que ceux qui peuvent en bénéficier le plus y ont accès. Dans le cas des crèches, la rareté impose de faire des choix, et chaque choix implique un coût d’opportunité.
<ul>
<li><em>Dans quelle mesure est-il possible de mettre en place un mécanisme optimal d’attribution des places en crèche ? Quelles sont les conséquences des différents choix de conception ?</em></li>
</ul></li>
<li><strong>Puzzle n°2</strong> : Parmi les populations les plus vulnérables on trouve une part importante de familles monoparentales bénéficiaires de minima-sociaux. Une solution proposée dans la droite ligne des politiques d’activation est l’accompagnement vers l’emploi.
<ul>
<li><em>Les programmes d’accompagnement global vers l’emploi permettent-ils aux familles monoparentales de sortir de la pauvreté par l’activité ?</em></li>
</ul></li>
<li><strong>Puzzle n°3</strong> : le système socio-fiscal français – particulièrement les aides des CAF – est complexe, peu lisible et les incitations très différentes suivant les configurations familiales
<ul>
<li><em>Comment réagissent les mamans-solo pauvres aux incitations du système socio-fiscal français ?</em></li>
</ul></li>
</ul>
</section>
</section>
<section id="rage-against-the-matching" class="level1">
<h1>Rage against the matching</h1>
<p>Ce chapitre est co-signé avec Julien Combe, professeur d’économie à l’école polytechnique et porte sur les mécanismes d’affectations des places en crèche et une analyse des inégalités sociales d’accès liées au fonctionnement des commissions d’attribution. Dans cet article, nous considérons l’accès à la crèche comme un problème d’appariement où la demande rencontre l’offre grâce à un mécanisme d’attribution centralisé organisé par les autorités locales.</p>
<p>Nos principales contributions sont doubles. Premièrement, nous fournissons des modèles et des algorithmes pour différentes versions du problème d’attribution de crèche avec des propriétés bien comprises. Les applications fournissent aux décideurs de nouveaux outils pour attribuer aux parents leur crèche préférée suivant des priorités avec diversité et des contraintes multidimensionnelles. Deuxièmement, nous utilisons deux études de cas pour analyser les effets des contraintes de diversité, des priorités et des mécanismes d’attribution sur les inégalités dans l’accès en crèche selon différentes dimensions.</p>
<p>Nous avons remarqué que l’organisation des commissions d’affectation présentait certaines caractéristiques familières. En particulier:</p>
<ol type="i">
<li>les affectations sont centralisées par les collectivités locales,</li>
<li>les parents s’inscrivent tout au long de l’année et soumettent leurs préférences pour les crèches qu’elles préfèrent,</li>
<li>la plupart des offres sont disponibles en septembre lorsque les enfants plus âgés passent à l’école maternelle, et</li>
<li>les collectivités locales organisent un comité d’attribution principal au printemps pour attribuer ces places.</li>
</ol>
<p>Le problème d’attribution des places en crèche est donc très similaire au problème de choix d’école pour lesquels des solutions bien définies et de nombreuses applications réussies existent déjà <span class="citation" data-cites="abdulkadiroglu2003">(<a href="#ref-abdulkadiroglu2003" role="doc-biblioref">Abdulkadiroğlu and Sönmez 2003</a>)</span>.</p>
<p>Dans cette littérature, l’objectif est généralement de définir des appariements <em>stables</em> et des algorithmes pour les trouver. La <em>stabilité</em> est une propriété que nous voulons qu’un appariement respecte afin de justifier aux parents <em>pourquoi</em> l’attribution est ainsi. La motivation théorique pour se concentrer sur des ensembles d’appariements stables est que si le résultat du marché est instable, il y a des agents ou des paires d’agents qui ont l’incitation à contourner l’appariement [@roth2008]. Dans certains cas, les chercheurs et/ou les décideurs utilisent déjà les résultats de la littérature sur la conception des marchés (<em>Market design</em>) pour fournir des mécanismes d’attribution des places en crèche.</p>
<p>Le terme <em>marché</em> a une charge politique importante, mais pas pour tout le monde et pas de la même manière. Pour certaines personnes, le terme de <em>marché</em> n’évoque rien de particulier, c’est un terme <em>inerte</em> qui désigne, notamment, un lieu où l’on fait des achats. Pour d’autres, il évoque le vocabulaire des <em>néolibéraux</em> et sa simple prononciation suscite une forme de défiance envers celui ou celle qui l’emploie. Pour des chercheurs en économie, le terme <em>marché</em> a un sens bien particulier. De plus, les <em>marchés</em> que nous définissons équilibrent offre et demande à partir d’un <em>algorithme</em>. Là aussi, la polysémie du terme et les enjeux politiques associés sont grands.</p>
<section id="market-design-et-économie-politique" class="level3">
<h3 class="anchored" data-anchor-id="market-design-et-économie-politique">Market design et économie politique</h3>
<p>Notre travail ne consiste pas à proposer une mise à jour des logiciels des directions petite enfance des territoires – même si cela peut passer par là – mais à concevoir des <em>places de marché</em>. Si nous utilisons ces termes, c’est parce que nous nous intéressons aux <em>transactions</em> que ce système permet d’organiser et à ce que la <em>société</em> tire d’une telle organisation. Les économistes<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a> ont tendance à adopter des définitions assez larges de ce qui constitue une transaction et (donc) un marché <span class="citation" data-cites="satz2010">(<a href="#ref-satz2010" role="doc-biblioref">Satz 2010</a>)</span>. Des précisions s’imposent.</p>
<p>En bref, un marché est une institution qui facilite les transactions. Il peut être formel ou informel, conçu, encadré, physique, virtuel, utilisant un système de prix ou non… Un point important est que les caractéristiques du marché affectent qui négocie, ce qui est négocié et les termes de ces transactions <span class="citation" data-cites="li2017">(<a href="#ref-li2017" role="doc-biblioref">Li 2017</a>)</span>. Ainsi, les <em>places de marché</em> se présentent sous de nombreuses formes et ne sont pas uniquement, ni même principalement, des marchés de biens et services dont la seule fonction est la découverte des prix. @roth2018 définit les places de marché comme<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a> “<em>l’infrastructure, les règles et les coutumes par lesquelles les informations sont échangées et les transactions effectuées, qui peuvent être des parties relativement petites de grands marchés. Les participants peuvent avoir de vastes ensembles de stratégies, c’est-à-dire de nombreuses options à leur disposition au-delà de celles disponibles sur une place de marché particulière</em>”.</p>
<p>Sur de nombreux marchés, nous nous soucions de savoir avec qui nous échangeons. Dans ces configurations, nous ne pouvons pas nous contenter de choisir ce que nous voulons, même si nous en avons les moyens : nous devons aussi être choisis. Le marché des modes d’accueils fait partie de ces marchés d’appariement (<em>matching markets</em>). Il existe des lieux d’inscriptions centralisés (les guichets uniques) donnant accès à une place de marché : les commissions d’admission des modes d’accueil (CAMA). Ces dernières sont en charge de l’appariement entre les offres de différents gestionnaires et les demandes des parents. Bien qu’elles proposent principalement des places en établissements d’accueil collectif du jeune enfant (EAJE) gérés, de près ou de loin, par le territoire, certaines proposent aussi des places dans des crèches associatives, des crèches familiales, des crèches d’entreprises, hospitalières ou universitaires,… En outre, cette place de marché n’est pas l’unique lieu des transactions pour les modes d’accueils. Les parents ont également d’autres options. Ils peuvent passer un contrat privé avec une assistante maternelle ou une crèche privée, s’occuper eux-mêmes de leurs enfants, définir une organisation repartissant la garde entre eux, des membres de leur famille ou d’autres liens sociaux, etc.</p>
<p>Pour un marché donné et une définition de la stabilité, une appariement stable peut ne pas exister, ou il peut y en avoir plusieurs. Il existe modèles, algorithmes et façon de poser le problème qui peuvent produire des très différents, c’est-à-dire en termes de distribution des affectations, ainsi qu’un ensemble de . Comme le souligne <span class="citation" data-cites="li2017">Li (<a href="#ref-li2017" role="doc-biblioref">2017</a>)</span>, une conséquence est plus riche qu’un résultat, c’est une “”. Il s’agit alors de peser et de résoudre les compromis entre différents objectifs et contraintes. Les modèles et la théorie aident à clarifier quels sont (certains de) ces compromis.</p>
<p>D’expérience, de nombreuses institutions locales collectent les préférences sur les jours de la semaine et attribuent les dossiers en conséquence<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a>. Ce simple changement dans la manière dont les préférences sont collectées a des conséquences importantes sur la définition de la stabilité.</p>
<p>Les décideurs sont familiers avec les détails de leur environnement, et pourtant ils ne savent souvent pas comment formuler leurs objectifs en termes précis ou réalisent qu’ils sont conflictuels. Cependant, la théorie aide à fournir “<em>des orientations sans prescrire une théorie éthique entière</em>” <span class="citation" data-cites="li2017">(<a href="#ref-li2017" role="doc-biblioref">Li 2017</a>)</span>.</p>
<p>De nombreux objectifs politiques dépendent de ce qui est réalisable. Par exemple, un décideur politique pourrait penser qu’il est moralement obligatoire de mettre en place un système qui est optimal au sens de Pareto<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a> pour les familles et respecte les priorités. Mais cela n’est pas possible <span class="citation" data-cites="abdulkadiroglu2003">(<a href="#ref-abdulkadiroglu2003" role="doc-biblioref">Abdulkadiroğlu and Sönmez 2003</a>)</span> donc cela ne peut pas être une contrainte morale ou politique. Lorsque l’attribution se fait en allouant des places sur les jours de la semaine, les développements récents sur l’appariement avec des contraintes multidimensionnelles pour la garde d’enfants <span class="citation" data-cites="kamada2023">(<a href="#ref-kamada2023" role="doc-biblioref">Kamada and Kojima 2023</a>)</span> et les relactions de réfugiés <span class="citation" data-cites="delacrétaz2023">(<a href="#ref-delacrétaz2023" role="doc-biblioref">Delacrétaz, Kominers, and Teytelboym 2023</a>)</span> fournissent différentes définitions de la stabilité et des algorithmes pour trouver des affectations stables avec d’autres propriétés souhaitables. Un résultat important de ces articles est qu’aucun algorithme ne peut respecter les priorités<a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a> et ne pas laisser de places vides. Encore une fois, les deux ne peuvent pas être réalisés, donc cela ne peut pas être un objectif politique. Cette littérature récente fournit des solutions théoriques bien adaptées au problème d’attribution de places en crèche avec des contraintes multidimensionnelles.</p>
<p>Cependant, la mise en œuvre dans la vie réelle ajoute une autre couche de complexité. En effet, une autre caractéristique importante du système français est l’existence de contraintes de diversité dans toutes les structure et les procédures d’attribution. Les contraintes de diversité impliquent que les capacités au sein des crèches sont divisées en <em>groupes</em>, c’est-à-dire en ensembles de capacités avec des règles de priorité attachées aux <em>groupes</em>. Par exemple, certaines capacités seront réservées aux enfants de 6 à 12 mois uniquement, et d’autres aux enfants de 12 à 24 mois. Ces contraintes de diversité peuvent être <em>rigides</em> lorsque les groupes n’acceptent qu’un seul groupe, comme dans les exemples précédents. Parfois, les contraintes sont <em>flexibles</em> et définissent un ordre de préférence sur les groupes. Par exemple, un groupe peut accepter des enfants de 12 à 24 mois mais aussi des enfants plus âgés s’il y a suffisamment de capacité pour les accueillir. Alors que les formes les plus courantes de contraintes de diversité sont les groupes d’âge, les décideurs politiques et/ou les gestionnaires définissent de nombreuses autres formes de contraintes de diversité<a href="#fn8" class="footnote-ref" id="fnref8" role="doc-noteref"><sup>8</sup></a>.</p>
</section>
<section id="principale-contribution-théorique" class="level2">
<h2 class="anchored" data-anchor-id="principale-contribution-théorique">Principale contribution théorique</h2>
<p>Ces contraintes de diversité jouent un rôle important dans le manque de transparence des procédures d’attribution de places en crèche. En effet, les commissions d’attribution ne trient pas simplement les dossiers par priorités dans une crèche, elles considèrent l’attribution au sein de groupes, dont les définitions varient à l’intérieur et entre les crèches, générant ainsi plus ou moins de concurrence entre les groupes et donc des variations dans les probabilités d’attribution. Dans un appariement donné, il peut y avoir des enfants avec des scores de priorité bas attribués à une crèche que les parents ayant une priorité plus élevée voulaient mais ont été rejetés. Ainsi, la notion de stabilité ne peut pas être uniquement basée sur les scores de priorité, elle doit prendre en compte la répartition des capacités en groupes et les priorités à l’intérieur et entre les groupes.</p>
<p>Fournir une notion de stabilité dans un cas avec des contraintes multidimensionnelles et de diversité est donc à la fois pertinent sur le plan théorique et nécessaire pour assurer la transparence et le respect du processus.</p>
<p>Notre résultat principal pose la définition d’une places de marché pour l’attribution des places en crèche (DAM) comme trois éléments que les décideurs doivent choisir :</p>
<ol type="1">
<li>Une version du problème : qu’ils considèrent les demandes avec des jours spécifiques ou non ;</li>
<li>Une partition des capacités en <em>groupes</em>, c’est-à-dire un ensemble de capacités avec des règles de priorité attachées dans chaque crèche pour définir les contraintes de diversité ;</li>
<li>Une définition de <em>l’équité</em> : avec des scores de priorité et si les mécanismes doivent éliminer l’envie justifiée, tolérer certaines petites déviations ou considérer uniquement les demandes initialement réalisables.</li>
</ol>
<p>En nous appuyant sur le travail de <span class="citation" data-cites="ehlers2014">Ehlers and Klaus (<a href="#ref-ehlers2014" role="doc-biblioref">2014</a>)</span> dans un cas sans attribution de jours spécifiques, <span class="citation" data-cites="kamada2023">Kamada and Kojima (<a href="#ref-kamada2023" role="doc-biblioref">2023</a>)</span> et <span class="citation" data-cites="delacrétaz2023">Delacrétaz, Kominers, and Teytelboym (<a href="#ref-delacrétaz2023" role="doc-biblioref">2023</a>)</span> dans un cas avec attribution de jours spécifiques, nous proposons des notions de stabilité pour différentes versions du problème d’attribution de places en crèche avec des contraintes de diversité.</p>
<p>Notre principal résultat énonce ensuite que pour chaque DAM, nous pouvons trouver l’attribution équitable optimale unique pour les familles (SOFA), qui respecte la définition <em>choisie</em> de l’absence d’envie. Nous fournissons également une définition supplémentaire de stabilité sur les <em>demandes initialement réalisables</em>. À partir d’un SOFA avec toutes les demandes, nous montrons dans un autre théorème que supprimer les demandes initialement irréalisables est préférable pour tous les parents et donc, améliore au sens de Pareto l’attribution qu’ils reçoivent. Dit autrement, les personnes avec des scores élevées dont le voeu ne peut être réalisé dès le départ en raison d’un manque de capacité génèrent des externalités négatives sur les dossiers moins prioritaires qui pourraient être affectés. En retirant ces voeux, les personnes à qui on retire les voeux ne sont pas pénalisés puisque ces voeux ne pouvaient de toute façon être satisfaits ; mais les retirer permet à d’autres familles d’avoir parfois un meilleur choix. En pratique, ce théorème s’avère le plus utile dans les seconds tours où il y a beaucoup plus de jours vides dans les groupes.</p>
</section>
<section id="implication-pour-les-politiques-publiques" class="level2">
<h2 class="anchored" data-anchor-id="implication-pour-les-politiques-publiques">Implication pour les politiques publiques</h2>
<p>Une fois que les décideurs politiques définissent leur DAM, les procédures proposées offrent plusieurs avantages distincts par rapport aux pratiques actuelles:</p>
<ol type="1">
<li>Ces outils informatiques peuvent rapidement traiter un grand nombre de demandes, ce qui permet de gagner du temps pour ceux impliqués dans l’organisation et la participation aux commissions d’attribution.</li>
<li>Nos modèles clarifient ce qui peut être fait et ce qui ne peut pas l’être, ainsi que les compromis de chaque mécanisme d’attribution. D’un point de vue normatif, ils garantissent des affectations <em>justes</em> au sens où ils éliminent les <em>envies justifiées</em> sur la base d’une définition claire et choisie. Les décideurs politiques choisissent s’ils veulent respecter strictement les priorités ou accueillir davantage d’enfants en autorisant une adaptation faible et/ou en ne tenant compte que des demandes initialement réalisables.</li>
<li>Toutes les décisions d’attribution sont traçables et peuvent être expliquées à chaque famille. Pour chaque attribution, nous fournissons un tableau pour chaque crèche qui justifie chaque décision. Une transparence totale est possible, si les décideurs politiques souhaitent aller vers cette direction.</li>
<li>En garantissant que les priorités sont toujours respectées et individuellement justifiables, ils peuvent créer un bien public: ces mécanismets assurent une forme de <em>justice procédurale</em> et peuvent déplacer les préoccupations éthiques et de justice vers la <em>justice distributive</em>. Puisque les priorités sont toujours respectées, la société peut débattre de ce qui constitue des inégalités justes.</li>
<li>Les décideurs politiques peuvent définir des distributions d’affectation cibles en choisissant les parts de places qu’ils veulent attribuer à certains groupes. Nos modèles sont suffisamment flexibles pour prendre en compte de nombreuses contraintes. En particulier, la définition de quotas de diversité (flexibles) est un outil puissant pour garantir que l’affectation satisfait certaines exigences de distribution. Sans notre procédure, ce type d’objectifs politiques est très difficile à atteindre. Ou du moins, difficile à justifier.</li>
<li>Ces outils peuvent également être utilisés pour simuler les effets de la modification de certains paramètres et informer les décideurs politiques en utilisant des scénarios <em>et si</em>.</li>
</ol>



</section>
</section>


<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-abdulkadiroglu2003" class="csl-entry" role="listitem">
Abdulkadiroğlu, Atila, and Tayfun Sönmez. 2003. <span>“School Choice: A Mechanism Design Approach.”</span> <em>American Economic Review</em> 93 (3): 729–47. <a href="https://doi.org/10.1257/000282803322157061">https://doi.org/10.1257/000282803322157061</a>.
</div>
<div id="ref-avenel2017" class="csl-entry" role="listitem">
Avenel, Cyprien, Marine Boisson Cohen, Sandrine Dauphin, Nicolas Duvoux, Christophe Fourel, Manon Julien, and Bruno Palier. 2017. <em>L’investissement social : quelle stratégie pour la France ?</em> La documentation Française. Paris.
</div>
<div id="ref-bono2021" class="csl-entry" role="listitem">
Bono, Pierre-Henri, Rozenn Desplatz, Sandra Debu, and Clément Lacouette-Fougère. 2021. <span>“Le lent développement des évaluations d<span>’</span>impact en France : une approche par les acteurs.”</span> <em>Revue francaise d’administration publique</em> N° 177 (1): 17–28. <a href="http://www.cairn.info/revue-francaise-d-administration-publique-2021-1-page-17.htm">http://www.cairn.info/revue-francaise-d-administration-publique-2021-1-page-17.htm</a>.
</div>
<div id="ref-delacrétaz2023" class="csl-entry" role="listitem">
Delacrétaz, David, Scott Duke Kominers, and Alexander Teytelboym. 2023. <span>“Matching Mechanisms for Refugee Resettlement.”</span> <em>American Economic Review</em>, no. 10 (October): 2689–2717. <a href="https://doi.org/10.1257/aer.20210096">https://doi.org/10.1257/aer.20210096</a>.
</div>
<div id="ref-ehlers2014" class="csl-entry" role="listitem">
Ehlers, Lars, and Bettina Klaus. 2014. <span>“Strategy-Proofness Makes the Difference: Deferred-Acceptance with Responsive Priorities.”</span> <em>Mathematics of Operations Research</em> 39 (4): 949–66. <a href="https://doi.org/10.1287/moor.2014.0662">https://doi.org/10.1287/moor.2014.0662</a>.
</div>
<div id="ref-kamada2023" class="csl-entry" role="listitem">
Kamada, Yuichiro, and Fuhito Kojima. 2023. <span>“Fair Matching Under Constraints: Theory and Applications.”</span> <em>The Review of Economic Studies</em>, April. <a href="https://doi.org/10.1093/restud/rdad046">https://doi.org/10.1093/restud/rdad046</a>.
</div>
<div id="ref-li2017" class="csl-entry" role="listitem">
Li, Shengwu. 2017. <span>“Ethics and Market Design.”</span> <em>Oxford Review of Economic Policy</em> 33 (4): 705–20. <a href="https://www.jstor.org/stable/48539480">https://www.jstor.org/stable/48539480</a>.
</div>
<div id="ref-satz2010" class="csl-entry" role="listitem">
Satz, Debra. 2010. <em>Why Some Things Should Not Be for Sale: The Moral Limits of Markets</em>. Edited by Debra Satz. Oxford University Press. <a href="https://doi.org/10.1093/acprof:oso/9780195311594.003.0000">https://doi.org/10.1093/acprof:oso/9780195311594.003.0000</a>.
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>Voir notamment le livre <span class="citation" data-cites="avenel2017">Avenel et al. (<a href="#ref-avenel2017" role="doc-biblioref">2017</a>)</span> reprenant les ensignements d’un cycle de séminaire sur la définition d’une stratégie d’investissement sociale pour la France.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>Voir notamment le livre <span class="citation" data-cites="avenel2017">Avenel et al. (<a href="#ref-avenel2017" role="doc-biblioref">2017</a>)</span> reprenant les ensignements d’un cycle de séminaire sur la définition d’une stratégie d’investissement sociale pour la France.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>dont nous faisons partie.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>“<em>infrastructure, rules, and customs through which information is exchanged and transactions are made [that] can be relatively small parts of large markets. Participants may have large strategy sets, i.e., many options available to them beyond those available in any particular marketplace</em>”<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>En l’absence de jours spécifiques, un enfant occupe un siège, qui est un bien indivisible et unitaire. Cependant, dans des contextes avec des jours spécifiques, un enfant peut prendre certains jours et le reste peut être attribué à un autre avec des préférences complémentaires, ou non. Une place n’est plus indivisible et unitaire.<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p>Dans ce contexte, une affectation Pareto efficace implique que la distribution des places en crèche ne peut pas être améliorée d’une manière qui bénéficie à au moins un participant sans nuire à un autre participant.<a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn7"><p>avec différentes définitions dans les deux articles.<a href="#fnref7" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn8"><p>par exemple, pour les parents dont les horaires varient au fil des mois ou avec des horaires de travail décalés, ceux qui sont dans une politique active du marché du travail etc.<a href="#fnref8" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>